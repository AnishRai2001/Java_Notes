ğŸ“ AWS S3 File Upload Flow (Spring Boot - Note)

when we are storeing only single Image

âœ… 1. Add AWS S3 Config in application.properties

aws.bucket-name=springbucketbtm
aws.region=ap=
aws.access-key=
aws.secret-key=

Why?
To provide AWS credentials and region details to the application so it can connect to S3.

âœ… 2. Create S3Config.java
@Configuration
public class S3Config {

Â    @Value("${aws.region}")
Â    private String region;

Â    @Value("${aws.access-key}")
Â    private String accessKey;

Â    @Value("${aws.secret-key}")
Â    private String secretKey;

Â    @Bean
Â    public S3Client s3Client() {
Â        AwsBasicCredentials credentials = AwsBasicCredentials.create(accessKey, secretKey);
Â        return S3Client.builder()
Â                .region(Region.of(region))
Â                .credentialsProvider(StaticCredentialsProvider.create(credentials))
Â                .build();
Â    }
}

Why?
This creates a singleton S3Client bean using AWS credentials. Itâ€™s used later to upload files to the S3 bucket.



âœ… 3. Create S3Service.java

@Service
pub4
Why?
This service handles:

Uploading a file to S3.

Saving the image URL in the Car entity (in DB).

Returns the S3 image URL.


âœ… 4. Create CarController.java

@RestController
@RequestMapping("/api/cars")
public class CarController {

Â    private final S3Service s3Service;

Â    @Autowired
Â    public CarController(S3Service s3Service) {
Â        this.s3Service = s3Service;
Â    }

Â    @PostMapping("/{bucketName}/{carId}/upload-image")
Â    public ResponseEntity<String> uploadCarImage(
Â            @PathVariable Long carId,
Â            @RequestParam("file") MultipartFile file
Â    ) {
Â        try {
Â            String imageUrl = s3Service.uploadFile(file, carId);
Â            return ResponseEntity.ok("Image uploaded successfully: " + imageUrl);
Â        } catch (Exception e) {
Â            return ResponseEntity.badRequest().body("Failed to upload image: " + e.getMessage());
Â        }
Â    }
}

How to Explain in Interview

ğŸ‘‰ "In my project, I implemented image upload using AWS S3. The flow was simple:

1. I stored AWS credentials and bucket details in application.properties.


2. I created a S3Config class that provides a singleton S3Client bean using AWS SDK.


3. Then I built a S3Service that handles file uploads â€” it prepares the PutObjectRequest, uploads to S3, and returns the file URL.


4. Finally, I exposed a REST endpoint in CarController that takes MultipartFile from client, calls the service, and responds with the uploaded image URL.



This way, whenever a user uploads an image for a Car entity, it gets stored in S3 and the image URL is stored in DB for later retrieval."
